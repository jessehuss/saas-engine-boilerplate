---
import siteConfig from '../config/site.config';

const primaryColor = siteConfig.primaryColor;
---

<form id="contact-form" class="max-w-2xl mx-auto space-y-6">
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div>
      <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
        Name *
      </label>
      <input 
        type="text" 
        id="name" 
        name="name" 
        required 
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
        placeholder="Your name"
      />
    </div>
    
    <div>
      <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
        Email *
      </label>
      <input 
        type="email" 
        id="email" 
        name="email" 
        required 
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
        placeholder="your@email.com"
      />
    </div>
  </div>
  
  <div>
    <label for="subject" class="block text-sm font-medium text-gray-700 mb-2">
      Subject
    </label>
    <input 
      type="text" 
      id="subject" 
      name="subject" 
      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
      placeholder="What's this about?"
    />
  </div>
  
  <div>
    <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
      Message *
    </label>
    <textarea 
      id="message" 
      name="message" 
      required 
      rows="6" 
      class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
      placeholder="Tell us about your project..."
    ></textarea>
  </div>
  
  <div id="form-message" class="hidden px-4 py-3 rounded-lg"></div>
  
  <button 
    type="submit" 
    class="w-full px-6 py-3 rounded-lg font-medium text-white shadow-lg hover:opacity-90 transition-all"
    style={`background-color: ${primaryColor};`}
  >
    Send Message
  </button>
</form>

<script>
  const form = document.getElementById('contact-form');
  const messageDiv = document.getElementById('form-message');
  
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(form as HTMLFormElement);
    const data = Object.fromEntries(formData);
    
    const submitButton = form?.querySelector('button[type="submit"]') as HTMLButtonElement;
    submitButton.disabled = true;
    submitButton.textContent = 'Sending...';
    
    try {
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });
      
      const result = await response.json();
      
      if (response.ok) {
        messageDiv?.classList.remove('hidden', 'bg-red-50', 'text-red-700', 'border', 'border-red-200');
        messageDiv?.classList.add('bg-green-50', 'text-green-700', 'border', 'border-green-200');
        messageDiv!.textContent = 'Message sent successfully! We\'ll get back to you soon.';
        (form as HTMLFormElement).reset();
      } else {
        throw new Error(result.error || 'Failed to send message');
      }
    } catch (error) {
      messageDiv?.classList.remove('hidden', 'bg-green-50', 'text-green-700', 'border', 'border-green-200');
      messageDiv?.classList.add('bg-red-50', 'text-red-700', 'border', 'border-red-200');
      messageDiv!.textContent = 'Error: ' + (error instanceof Error ? error.message : 'Unknown error');
    } finally {
      submitButton.disabled = false;
      submitButton.textContent = 'Send Message';
    }
  });
</script>

